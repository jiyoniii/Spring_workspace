package org.zerock.controller;

import java.text.SimpleDateFormat;

import org.springframework.beans.propertyeditors.CustomDateEditor;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.InitBinder;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.zerock.domain.SampleDTO;
import org.zerock.domain.TodoDTO;

import lombok.extern.log4j.Log4j;


@Controller
@RequestMapping("/sample/*")
@Log4j
//Log4j는 롬복인데,만약 빨간색으로 오류가 나는 경우엔 pom.xml로 가서 <scope>provided<scope>를 주석처리함.junit의 scope도 주석처리!

public class SampleController {
	@InitBinder
	public void initBinder(WebDataBinder binder) {
		SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-mm-dd");
		binder.registerCustomEditor(java.util.Date.class, new CustomDateEditor(dateFormat, false));
	}
	
	
	
	//requestMethod에서 get, post, put, delete 의 네가지 방식이 사용 가능함. jsp에서는doGet, doPost만 가능했었음.
	@RequestMapping(value="/basic",method= {RequestMethod.GET,RequestMethod.POST})
	public void basic() {
		
		/* Log.info("basic...."); */
			System.out.println("basic....");
	}
	
	@GetMapping("/ex01")
	public void ex01(SampleDTO dto) {
		System.out.println(""+dto); 
		//SampleDTO(name=null, age=0) 로 출력이 됨. dto에서 넘어오는 값이 없기 때문에 오류가 나지 않고 null로 나오게 됨.
		//메서드이름과 똑같은곳으로 이동할 경우에는 return을 쓰지말고 void로 처리하고, 이동 할 jsp의 이름이 다를 경우 return을 사용해야 함.
	}
	
	@GetMapping("/ex02")
	public String ex02(@RequestParam("name") String name, @RequestParam("age") int age) {
		
		System.out.println("name: "+ name);
		System.out.println("age: "+ age);
		//http://localhost:8181/sample/ex02?name=AAA&age=10 이렇게 url에 값을 직접 입력하면
		//name: AAA age: 10 으로 콘솔에 출력하게됨.
		//위에서 @RequestParam을 삭제해도 동일하게 읽어오게됨.
		
		
		return "ex02";
	}
	
	//InitBinder (137p)
	@GetMapping("/ex03")
	public String ex03(TodoDTO todo) {
		
		System.out.println("todo : "+todo);
		log.info("todo : "+todo);
		
		return "ex03";
	}
	
	//142page model
	@GetMapping("/ex04")
	public String ex04(SampleDTO dto,@ModelAttribute("page")int page) {
		
		System.out.println("dto : "+dto);
		System.out.println("page :"+page);
		
		log.info("dto : "+dto);
		log.info("page :"+page);
		
		return "/sample/ex04";
	}
	
}
